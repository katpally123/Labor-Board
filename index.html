<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>CRETs Labor Board — Rotations</title>
  <link rel="stylesheet" href="styles.css"/>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.2/Sortable.min.js" defer></script>
  <script src="app.js" defer></script>
</head>
<body>
  <header class="hdr">
    <div class="brand">CRETs Labor Board</div>
    <div class="ctrls">
      <label class="ctrl"><span>Date</span><input id="datePick" type="date"/></label>
      <label class="ctrl"><span>Shift</span>
        <select id="shiftType"><option>Day</option><option>Night</option></select>
      </label>
      <label class="ctrl"><span>Quarter</span>
        <select id="quarterSel"><option value="Q1">Q1</option><option value="Q2">Q2</option><option value="Q3">Q3</option></select>
      </label>

      <div class="dropdown">
        <button id="unBtn" class="btn">Unassigned <span id="unCount">0</span> ▾</button>
        <div id="unMenu" class="menu">
          <input id="unSearch" class="search" placeholder="Search..." />
          <div id="unList" class="list"></div>
          <div class="menu-actions">
            <label>Send to
              <select id="unTarget"></select>
            </label>
            <button id="unAssign" class="btn btn-primary">Assign</button>
          </div>
        </div>
      </div>

      <button id="autoAssign" class="btn">Auto-Assign</button>
      <div id="autoPanel" class="panel">
        <div class="row">
          <label>Target E2S stations:
            <input id="e2sTarget" type="number" min="0" max="48" value="36"/>
          </label>
          <label>Fairness:
            <select id="fairness"><option value="off">Off</option><option value="light" selected>Light</option><option value="strong">Strong</option></select>
          </label>
          <label><input id="critFirst" type="checkbox" checked/> Critical first</label>
        </div>
        <div class="row">
          <button id="aaPreview" class="btn btn-primary">Preview</button>
          <button id="aaApply" class="btn">Apply</button>
          <button id="aaCancel" class="btn btn-ghost">Cancel</button>
        </div>
        <div id="aaMsg" class="tiny-note"></div>
      </div>

      <button id="buildNow" class="btn btn-ghost">Rebuild</button>
    </div>

    <div class="kpis">
      <div class="kpi"><span>Planned</span><strong id="kpiPlanned">0</strong></div>
      <div class="kpi"><span>Actual</span><strong id="kpiActual">0</strong></div>
      <div class="kpi"><span>Variance</span><strong id="kpiVariance">0</strong></div>
    </div>
  </header>

  <section class="uploads">
    <div class="file">
      <label>Roster (required)</label>
      <input type="file" id="fileRoster" accept=".csv"/>
      <small id="hintRoster" class="hint">No file chosen</small>
    </div>
    <div class="file">
      <label>Swap OUT (Approved)</label>
      <input type="file" id="fileSwapOut" accept=".csv"/>
      <small id="hintSwapOut" class="hint">No file chosen</small>
    </div>
    <div class="file">
      <label>Swap IN (Approved)</label>
      <input type="file" id="fileSwapIn" accept=".csv"/>
      <small id="hintSwapIn" class="hint">No file chosen</small>
    </div>
    <div class="file">
      <label>VET / VTO (Accepted)</label>
      <input type="file" id="fileVetVto" accept=".csv"/>
      <small id="hintVetVto" class="hint">No file chosen</small>
    </div>
    <div class="file">
      <label>Labor Share (optional)</label>
      <input type="file" id="fileLaborShare" accept=".csv"/>
      <small id="hintLaborShare" class="hint">No file chosen</small>
    </div>
  </section>

  <main class="board-wrap">
    <section id="BOARD" class="board"></section>
  </main>

  <!-- Lock modal -->
  <dialog id="lockDlg" class="modal">
    <h3 id="lockTitle">Lock Quarter?</h3>
    <p>This will record assignments for the current quarter and download a CSV snapshot.</p>
    <div class="row">
      <button id="lockYes" class="btn btn-primary">Lock & Continue</button>
      <button id="lockNo" class="btn btn-ghost">Cancel</button>
    </div>
    <small class="tiny-note">No data is stored — a CSV file will be downloaded.</small>
  </dialog>
</body>
</html>
